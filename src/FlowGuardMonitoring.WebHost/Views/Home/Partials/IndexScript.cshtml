<script>
    var sensorId = 0;
    var year = 2025;

    // Fetch data from the API
    fetch(`/api/SensorData/yearly?sensorId=${sensorId}&year=${year}`)
        .then(response => response.json())
        .then(data => {
            // Process data for the chart
            var chartData = data.map(d => ({
                day: d.Day,         // Date in 'yyyy-MM-dd' format
                average: d.Average  // Average value (null if no data)
            }));

            // Generate the chart using AG Charts
            agCharts.AgChart.create({
                container: document.getElementById('chart-container'),
                data: chartData,
                series: [{
                    type: 'line',
                    xKey: 'day',
                    yKey: 'average',
                    yName: 'Average Measurement',
                    stroke: '#47a9ff',
                    strokeWidth: 2,
                    marker: {
                        size: 5,
                        fill: '#47a9ff',
                        stroke: '#47a9ff'
                    },
                    tooltip: {
                        renderer: function(params) {
                            if (params.yValue === null) {
                                return 'No data available for this day';
                            } else {
                                return 'Average: ' + params.yValue.toFixed(2);
                            }
                        }
                    }
                }],
                axes: [
                    {
                        type: 'time',
                        position: 'bottom',
                        title: { text: 'Day of the Year' }
                    },
                    {
                        type: 'number',
                        position: 'left',
                        title: { text: 'Average Value' }
                    }
                ],
                legend: {
                    enabled: false
                }
            });
        })
        .catch(error => console.error('Error fetching sensor data:', error));
</script>